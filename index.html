<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, user-scalable=no,
		shrink-to-fit=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />

	<title>WiRoc Config</title>

	<style>
		@import 'ui/css/jquery.mobile-1.4.5.css';
	</style> 
    	<style>
		@import 'ui/css/evothings-app.css';
	</style>
	
    <style>
	.ui-navbar li .ui-btn {
		font-size: 2.5vw;
	}
	.ui-mobile label,
	div.ui-controlgroup-label {
		font-weight: normal;
		font-size: 4vw;
	}
	.ui-btn {
		margin: 1vw 0;
		padding-right: 1vw;
		padding-left: 1vw;
	}
	.ui-btn-icon-left {
	    padding-left: 40px;
	}

        /* Visible channel */
    	#channel-select-button span {
    		font-size: 20vw;
    	}
    	/* Channel list */
    	#channel-select-menu li a {
    		font-size: 4vw;
    		padding-top:0.5em;
    		padding-bottom:0.5em;
    	}
    	
    	label.default-channel {
		line-height: 16vw;
    		font-size: 10vw;
    		text-align: center;
    		margin-bottom: -1vw;
		height: 16vw;
    		/*transition: font-size 1s;*/
    	}
	label.custom-channel {
		line-height: 16vw;
    		font-size: 7vw;
    		text-align: center;
    		margin-bottom: -1vw;
		height: 16vw;
    		/*transition: font-size 1s;*/
    	}
    	.ui-select {
    		margin-top: 0px;
    	}
    	.channel.ui-field-contain {
    		width: 40%;
    		margin: auto;
    		margin-top:0px;
    	}
    	
    	 div.ui-controlgroup-label legend
    	 {
			margin-left:auto;
			margin-right:auto;
		 }
		
		
    	.ui-mobile [data-role=page] {
			position: inherit;
		}
		
		div.ui-checkbox {
		    display: inline-block;
		}
		
		#acknowledge-div {
			text-align:center;
		}
		
		.ui-controlgroup-label {
			text-align:center;
		}
		
		.ui-controlgroup-horizontal {
			text-align:center;
		}
		
		
		div.ui-controlgroup-controls {
		  	font-weight: normal;
			font-size: 16px;
		 }
		 
		
		.datarate div.ui-controlgroup-label{
		 	font-size: 3vw;
		 	margin: 0;
		}



		.datarate-disabled div.ui-controlgroup-label{
			opacity:0.4;
		}

		
		fieldset.ui-controlgroup {
			margin: .4em 0;
		}

		.scan-status {
			font-size:3vw;
		}
		p {
		    -webkit-margin-before: 1.5vw;
		    -webkit-margin-after: 1.5vw;
		    -webkit-margin-start: 0px;
		    -webkit-margin-end: 0px;
		}
		.page {
			margin-left:3vw;
			margin-right:3vw;
		}
		.device {
			font-size: 5vw;
			background-color:#e9e9e9;
			list-style-type: none;
		}

		#found-devices {
			padding-left: 0;
		}

		.device-header {
			font-weight: bold;
			font-size:7vw;
		}

		#battery-indicator {
			right: 35vw;
			position: absolute;
			top:1.5vw;
			width:8vw;
			height:5vw;
		}

		div.battery {
			width: 10vw;
			height: 5vw;
			border: 2px solid #000;
			background-color: #fff;
			top: 1vw;
			position:absolute;
		}
		.battery:after {
			content: '';
			display: block;
			width: 1vw;
			top: 1.5vw;
			height: 2vw;
			background-color: #000;
			position: absolute;
			right: -1vw;

		}
		div.battery .level {
			height: 100%;
			width: 2%;
		}
		div.battery .level.high {
			background-color: #27AE60;  
		}

		div.battery .level.med {
			background-color: #E67E22;  
		}

		div.battery .level.low {
			background-color: #E74C3C;  
		}

		div.battery .level.charging {
			background-color: #27AE60;  
			width: 100%;
			text-align: center;
		}
		div.battery .level.charging:before {
			content: '\e800';
			display: block;
			height: 100%;
			width: 100%;
			color: #fff;
			line-height: 40px;
			font-family: 'Battery';
			font-size: 25px;
		}
		#menu-left {
			font-size: 3.5vw;
			padding-left:32px;
			margin:0px;
		}

		#menu-right li ul li a.ui-btn {
			font-size: 3.5vw;
			padding-right: 32px;
			padding-left:2vw;
			padding-top:3vw;
			padding-bottom:3vw;
			cursor: pointer;
			white-space: normal; /* Stop long menu names from truncating */
		}
		#menu-right li a.ui-btn {
			font-size: 3.5vw;
			padding-right:32px;
			margin:0px;
		}
		#menu-right ol,
		#menu-right ul,
		#menu-right li {
		  list-style:none;
		}
		#menu-right li ul { /* Menu Item List */
		    position: absolute; /* Position absolutely */
		    display: none; /* Hide */
		    z-index:5000; /* Ensure visibility over other elements on page */
		    margin-top: 0px; /* Bring menu closer to button; not needed on mobile */
		}
		#menu-right li ul li {
		    //width: 30vw; /* Fixed width menu items*/
		    display: block; /* JQM makes a inline-blocks... reset it to block */
		}

		#menu-right {
			margin:0px;
			padding:0px;
		    	position:absolute;
			right:5px;
			top:3px;
		}
		#menu-right ul {
		    margin-right: 0.5em;
		    right: 0em;
		}

		/* */
		#popup-about-popup {
			width:70%;
			
		}
		.ui-popup > span {
			margin: 2vw 2vw;
		}


		/* advanced config*/
		div.advanced-config div.ui-input-text  {
			margin-top:0.5em;
		}
		div.advanced-config div.ui-checkbox{
			display:block;
		}
    </style>
	<script>
	// Redirect console.log to Evothings Workbench.
		if (window.hyper && window.hyper.log) { console.log = hyper.log }
	</script>

	<script src="cordova.js"></script>
	<script src="libs/jquery/jquery.js"></script>
	<script src="libs/peekabar/peekabar.js"></script>
	<script src="libs/jquery/jquery.mobile-1.4.5.js"></script>
	<script src="libs/evothings/evothings.js"></script>
	<script src="libs/evothings/ui/ui.js"></script>
	<script src="app.js"></script>
	<script>
		$(document).ready(function() {
			//$('#page-device-scan').show();
			//$('#page-basic-config').show();
			//app.getBatteryLevel(app.ui.displayBatteryLevel);
			app.searchDevicesErrorBar = new $.peekABar({ jqObjToAddBarTo: $('body'), autohide: true, backgroundColor: '#ffbf00' });
			app.batteryErrorBar = new $.peekABar({ jqObjToAddBarTo: $('div#notification-radio'), autohide: true, backgroundColor: '#ffbf00' });
			app.radioErrorBar = new $.peekABar({ jqObjToAddBarTo: $('div#notification-radio'), autohide: true, backgroundColor: '#ffbf00' });
			app.radioSuccessBar = new $.peekABar({ jqObjToAddBarTo: $('div#notification-radio'), autohide: true, backgroundColor: '#99ff99' });
			app.meosErrorBar = new $.peekABar({ jqObjToAddBarTo: $('div#notification-meos'), autohide: true, backgroundColor: '#ffbf00' });
			app.meosSuccessBar = new $.peekABar({ jqObjToAddBarTo: $('div#notification-meos'), autohide: true, backgroundColor: '#99ff99' });
			app.networkErrorBar = new $.peekABar({ jqObjToAddBarTo: $('div#notification-network'), autohide: true, backgroundColor: '#ffbf00' });
			app.networkSuccessBar = new $.peekABar({ jqObjToAddBarTo: $('div#notification-network'), autohide: true, backgroundColor: '#99ff99' });
			app.networkInfoBar = new $.peekABar({ jqObjToAddBarTo: $('div#notification-network'), autohide: true, backgroundColor: '#80d4ff' });
			app.miscStatusErrorBar = new $.peekABar({ jqObjToAddBarTo: $('div#notification-status'), autohide: true, backgroundColor: '#ffbf00' });
			app.miscSettingsErrorBar = new $.peekABar({ jqObjToAddBarTo: $('div#notification-settings'), autohide: true, backgroundColor: '#99ff99' });
			app.miscSettingsSuccessBar = new $.peekABar({ jqObjToAddBarTo: $('div#notification-settings'), autohide: true, backgroundColor: '#ffbf00' });
			app.miscServicesErrorBar = new $.peekABar({ jqObjToAddBarTo: $('div#notification-services'), autohide: true, backgroundColor: '#99ff99' });
			
			$('#wifiConnect').click(app.ui.onWifiPasswordConnectButton);
			$('#saveSettingButton').click(app.ui.onEditSettingSaveButton);


			$("input[name='radio-choice-channel-type']").on( "change", function(event, ui) {
				//alert(this.value);
							
				if (this.value == 'custom') {
					app.ui.onShowCustomChannelPage();
				} else {
					app.ui.onShowPredefinedChannelPage();
				}
			});

			$(":mobile-pagecontainer").on( "pagecontainerbeforechange", function( event, ui ) {
				if (typeof ui.toPage == "object") {
					var urlArray = ui.absUrl.split("#");
					var toPageName = "page-device-scan";
					if (urlArray.length > 1)
					{
						toPageName = urlArray[1];
					}
					if (toPageName == "page-device-scan") 
					{
						app.disconnect();
					} else if (toPageName == "page-advanced-config") 
					{
						//app.loadAdvanced();
					}
				}
			} );

			// update the background 
			$("#channel-select").on( "change", function(event, ui) {
				app.ui.updateBackgroundColor();
			});
			$("#acknowledgement").on( "change", function(event, ui) {
				app.ui.updateBackgroundColor();
			});
			$('input[type=radio][name=radio-choice-data-rate]').on("change", function(event, ui) {
				app.ui.updateBackgroundColor();
			});
			$("#sendtomeosenabled").on( "change", function(event, ui) {
				app.ui.updateBackgroundColor();
			});
			$("#sendtomeosip").on( "input propertychange paste", function(event, ui) {
				app.ui.updateBackgroundColor();
			});
			$('#sendtomeosipport').on("input propertychange paste", function(event, ui) {
				app.ui.updateBackgroundColor();
			});

			// Menu
			$('body').bind('hideOpenMenus', function(){
			    $("ul:jqmData(role='menu')").find('li > ul').hide();
			}); 
			var menuHandler = function(e) {
			    $('body').trigger('hideOpenMenus');
			    $(this).find('li > ul').show();
			    e.stopPropagation();
			};
			$("ul:jqmData(role='menu') li > ul li").click(function(e) {
			   $('body').trigger('hideOpenMenus');
			e.stopPropagation();
			});
			$('body').delegate("ul:jqmData(role='menu')",'click',menuHandler);
			$('body').click(function(e){
			   $('body').trigger('hideOpenMenus');
			});

			// about link
			$( "#popup-about-link" ).on("click", function (event, ui) { $( "#popup-about" ).popup( "open" ); return false; });

			$( "#tabs-main" ).on( "tabsactivate", function( event, ui ) { 
				if (ui.newTab.data("tabname") == "radio") {
					app.readBasicSettings();
				} else if (ui.newTab.data("tabname") == "meos") {
					app.readMeosSettings();
				};
			} );

		});
	</script>
</head>
<body ontouchstart=""><!-- ontouchstart="" enables low-delay CSS transitions. -->
	<div id="page-device-scan" data-role="page">
		<div data-role="header">
			<h1 style="font-size:3vw">WiRoc<br/>Config</h1>
		</div>
		<div id="notification-search-devices" style="height:1px"></div>

 		<div role="main" class="ui-content" class="page">
			<a href="#page-basic-config" data-transition="slide">Slide</a>
			<a href="#" onclick="app.ui.onStartScanButton()" class="ui-btn ui-btn-inline ui-corner-all start-button">START SCAN</a>
			<a href="#" onclick="app.ui.onStopScanButton()" class="ui-btn ui-btn-inline ui-corner-all stop-button">STOP SCAN</a>
	
			<p id="scan-status" class="scan-status">Scanning Paused</p>
	
			<ul id="found-devices" class="dynamic"></ul>
		</div>
	</div>


	
	<div id="page-basic-config" data-role="page">
		<div data-role="header">
			<a href="#page-device-scan" id="menu-left" class="ui-btn ui-corner-all ui-btn-inline ui-mini ui-btn-icon-left ui-icon-carat-l" data-rel="back" data-transition="slide">Back</a>			
			<h1 style="font-size:3vw">WiRoc<br/>Config</h1>
			<div id="battery-indicator">
				<div id="battery" class="battery">
					<div class="level"></div>
				</div>
			</div>
			<ul id="menu-right" data-role="menu">
			<li>
				<a href="#" onclick="return false;" data-role="button" data-icon="gear" data-inline="true" data-iconpos="right">Options</a>
				<ul data-role="listview" data-inset="true">
					<li><a href="#page-advanced-config">Advanced</a></li>
					<li><a href="#" id="popup-about-link">About</a></li>

				</ul>
			</li>
			</ul>      
		</div>

		<div data-role="popup" id="popup-about" data-dismissible="true">
			<a href="#" data-rel="back" data-role="button" data-theme="b" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
			<div data-role="header" data-theme="a">
				<h1>About</h1>
			</div>
			<span>
				<h1>WiRoc Config</h1>

				<table>
					<tr><td>Version</td><td>1.0</td></tr>
					<tr><td></td><td></td></tr>
					<tr><td></td><td></td></tr>
					<tr><td></td><td></td></tr>
				</table>
			</span>
		</div>
		<div data-role="main" class="ui-content" class="page" style="padding:0">
		<form>
			<h1 id="device-name" style="font-size:5vw;text-align: center;margin:0">WiRoc</h1>
			<div data-role="tabs" id="tabs-main">
			 	<div data-role="navbar">
					<ul>
					<li data-tabname="radio"><a href="#radio" data-ajax="false" id="tab-radio" class="ui-btn-active ui-state-persist">Radio</a></li>
					<li data-tabname="meos"><a href="#meos" data-ajax="false" id="tab-meos">MeOS</a></li>
					<li data-tabname="network"><a href="#network" data-ajax="false" id="tab-network">Network</a></li>
					</ul>
				</div>
				<div id="radio" class="ui-body-d ui-content" style="padding:2vw">
					<div id="notification-radio" style="height:1px"></div>
					<div>
						<fieldset data-role="controlgroup" data-type="horizontal">
							<input type="radio" name="radio-choice-channel-type" id="radio-choice-channel-type-default" value="default" checked="checked"><label for="radio-choice-channel-type-default">Predefined channel</label>
							<input type="radio" name="radio-choice-channel-type" id="radio-choice-channel-type-custom" value="custom"><label for="radio-choice-channel-type-custom">Custom channel</label>
						</fieldset>
					</div>
					<label id="channel-header" class="default-channel">Channel</label>
					<div class="ui-field-contain channel">
						<select name="channel" id="channel-select" data-native-menu="false">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5</option>
							<option value="6">6</option>
							<option value="7">7</option>
							<option value="8">8</option>
							<option value="9">9</option>
						</select>
					</div>
				     
					<div id="acknowledge-div">
		 				<label><input type="checkbox" id="acknowledgement">Request acknowledgement</label>
					</div>
					<div>
						<fieldset data-role="controlgroup" data-type="horizontal" class="datarate datarate-disabled">
							<legend>Data rate</legend>
							<input type="radio" name="radio-choice-data-rate" id="radio-choice-data-rate-1" value="146" disabled="disabled"><label for="radio-choice-data-rate-1">146 bps</label>
							<input type="radio" name="radio-choice-data-rate" id="radio-choice-data-rate-2" value="293" disabled="disabled"><label for="radio-choice-data-rate-2">293 bps</label>
							<input type="radio" name="radio-choice-data-rate" id="radio-choice-data-rate-3" value="586" disabled="disabled" checked="checked"><label for="radio-choice-data-rate-3">586 bps</label>
							<input type="radio" name="radio-choice-data-rate" id="radio-choice-data-rate-4" value="2148" disabled="disabled"><label for="radio-choice-data-rate-4">2148 bps</label>
							<input type="radio" name="radio-choice-data-rate" id="radio-choice-data-rate-5" value="7032" disabled="disabled"><label for="radio-choice-data-rate-5">7032 bps</label>
						</fieldset>
					</div>
					<div style="text-align:center">
						<div style="display:inline-block">
							<a href="#" onclick="app.ui.onReadBasicButton()" class="ui-btn ui-btn-inline ui-corner-all read-basic-button">READ</a>
							<a href="#" onclick="app.ui.onApplyBasicButton()" class="ui-btn ui-btn-inline ui-corner-all apply-basic-button">APPLY SETTINGS</a>
						</div>
					</div>
				</div>			
				<div id="meos" class="ui-body-d ui-content" style="padding:2vw">
					<div id="notification-meos" style="height:1px"></div>
					<div class="ui-field-contain advanced-config">
						<label for="sendtomeosenabled">Send punches to MeOS</label>
						<input type="checkbox" name="sendtomeosenabled" id="sendtomeosenabled">
					</div>
					<div class="ui-field-contain advanced-config">
						<label for="sendtomeosip">IP&nbsp;address:</label>
						<input type="text" name="sendtomeosip" id="sendtomeosip">
					</div>
					<div class="ui-field-contain advanced-config">
						<label for="sendtomeosipport">Port:</label>
						<input type="number" min="1" max="65535" name="sendtomeosipport" id="sendtomeosipport">
					</div>

					<div style="text-align:center">
						<div style="display:inline-block">
							<a href="#" onclick="app.ui.onReadMeosButton()" class="ui-btn ui-btn-inline ui-corner-all read-basic-button">READ</a>
							<a href="#" onclick="app.ui.onApplyMeosButton()" class="ui-btn ui-btn-inline ui-corner-all apply-basic-button">APPLY SETTINGS</a>
						</div>
					</div>
				</div>
				<div id="network" class="ui-body-d ui-content" style="padding:2vw">
					<div id="notification-network" style="height:1px"></div>
					<div style="text-align:left">
						<div style="display:inline-block">
							<a href="#" onclick="app.ui.onGetNetworkWifiListButton()" class="ui-btn ui-btn-inline ui-corner-all">Get/Refresh wifi list</a>
						</div>
					</div>

					<div id="wifi-networks" class="dynamic">Empty list</div>
					<hr/>
					<div style="text-align:left">
						<div style="display:inline-block">
							Renew IP: <span id="ipaddress" /><br/>
							<a href="#" onclick="app.ui.onRenewIPWifi()" class="ui-btn ui-btn-inline ui-corner-all" style="min-width:25vw">Wifi</a>
							<a href="#" onclick="app.ui.onRenewIPEthernet()" class="ui-btn ui-btn-inline ui-corner-all" style="min-width:25vw">Ethernet</a>
						</div>
					</div>

					<div data-role="popup" id="popupWifiLogin" data-theme="a" class="ui-corner-all">
						<form>
						<div style="padding:10px 20px;">
							<h3>Enter password</h3>
							<label for="wifiPassword" class="ui-hidden-accessible">Password:</label>
							<input type="password" name="wifiPassword" id="wifiPassword" value="" placeholder="password" data-theme="a">
							<button id="wifiConnect" class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-left ui-icon-check">Connect</button>
						</div>
						</form>
					</div>
				</div>

			</div>
		</form>
		</div>
	</div>







	<div id="page-advanced-config" data-role="page">
		<div data-role="header">
			<a href="#page-device-scan" id="menu-left" class="ui-btn ui-corner-all ui-btn-inline ui-mini ui-btn-icon-left ui-icon-carat-l" data-rel="back" data-transition="slide">Back</a>			
			<h1 style="font-size:3vw">WiRoc<br/>Config</h1>
			<div id="battery-indicator">
				<div id="battery" class="battery">
					<div class="level"></div>
				</div>
			</div>
			<ul id="menu-right" data-role="menu">
			<li>
				<a href="#" onclick="return false;" data-role="button" data-icon="gear" data-inline="true" data-iconpos="right">Options</a>
				<ul data-role="listview" data-inset="true">
					<li><a href="#" id="popup-about-link">About</a></li>

				</ul>
			</li>
			</ul>      
		</div>

		<div data-role="popup" id="popup-about" data-dismissible="true">
			<a href="#" data-rel="back" data-role="button" data-theme="b" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
			<div data-role="header" data-theme="a">
				<h1>About</h1>
			</div>
			<span>
				<h1>WiRoc Config</h1>

				<table>
					<tr><td>Version</td><td>1.0</td></tr>
					<tr><td></td><td></td></tr>
					<tr><td></td><td></td></tr>
					<tr><td></td><td></td></tr>
				</table>
			</span>
		</div>
		<div data-role="main" class="ui-content" class="page" style="padding:0">
		<form>
			<h1 id="device-name" style="font-size:5vw;text-align: center;margin:0">WiRoc</h1>
			<div data-role="tabs" id="tabs-adv">
			 	<div data-role="navbar">
					<ul>
					<li><a href="#status" data-ajax="false" id="tab-status" class="ui-btn-active ui-state-persist">Status</a></li>
					<li><a href="#services" data-ajax="false" id="tab-services">Services</a></li>
					<li><a href="#settings" data-ajax="false" id="tab-settings">Settings</a></li>
					<li><a href="#punches" data-ajax="false" id="tab-punches">Punches</a></li>
					</ul>
				</div>
				<div id="status" class="ui-body-d ui-content" style="padding:2vw">
					<div id="notification-status" style="height:1px"></div>
					<div style="text-align:left">
						<div style="display:inline-block">
							<a href="#" onclick="app.ui.onRefreshStatusButton()" class="ui-btn ui-btn-inline ui-corner-all">Get/Refresh</a>
						</div>
					</div>
					<div id="wiroc-status-content"></div>
				</div>
				<div id="services" class="ui-body-d ui-content" style="padding:2vw">
					<div id="notification-services" style="height:1px"></div>
					<div style="text-align:left">
						<div style="display:inline-block">
							<a href="#" onclick="app.ui.onRefreshServicesButton()" class="ui-btn ui-btn-inline ui-corner-all">Get/Refresh</a>
						</div>
					</div>
					<div id="wiroc-services-content"></div>
				</div>
				<div id="settings" class="ui-body-d ui-content" style="padding:2vw">
					<div id="notification-settings" style="height:1px"></div>
					<div style="text-align:left">
						<div style="display:inline-block">
							<a href="#" onclick="app.ui.onRefreshSettingsButton()" class="ui-btn ui-btn-inline ui-corner-all">Get/Refresh</a>
						</div>
					</div>
					<div id="wiroc-settings-content"></div>
					<div data-role="popup" id="popupAddEditSetting" data-theme="a" class="ui-corner-all">
						<form>
						<div style="padding:10px 20px;">
							<h3>Setting</h3>
							<label for="settingKey" class="ui-hidden-accessible">Key:</label>
							<input type="text" name="settingKey" id="settingKey" value="" placeholder="Key" data-theme="a">
							<label for="settingValue" class="ui-hidden-accessible">Value:</label>
							<input type="text" name="settingValue" id="settingValue" value="" placeholder="Value" data-theme="a">
							<button id="saveSettingButton" class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-left ui-icon-check">Save setting</button>
						</div>
						</form>
					</div>
				</div>
				<div id="punches" class="ui-body-d ui-content" style="padding:2vw">
					<div id="notification-punches" style="height:1px"></div>
					<div style="text-align:left">
						<div style="display:inline-block">
							<a href="#" onclick="app.ui.onSubscribePunchesButton()" data-subscribe="true" id="btnSubscribePunches" class="ui-btn ui-btn-inline ui-corner-all">Subscribe</a>
						</div>
					</div>
					<div id="wiroc-punches-content">
						<table id="wiroc-punches-table" width="100%" border=1>
							<thead><tr><th align=\"left\">Station</th><th align=\"left\">SI Card</th><th>Time</td></tr></thead>
							<tbody></tbody>
						</table>
					</div>
				</div>

			</div>
		</form>
		</div>
	</div>
</body>

</html>
